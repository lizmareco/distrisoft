generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model AperturaCaja {
  idAperturaCaja  Int               @id @default(autoincrement()) @map("id_apertura_caja")
  saldoInicial    Float             @map("saldo_inicial")
  saldoActual     Float             @map("saldo_actual")
  fechaApertura   DateTime          @map("fecha_apertura") @db.Timestamp(6)
  fechaCierre     DateTime          @map("fecha_cierre") @db.Timestamp(6)
  idCaja          Int               @map("id_caja")
  observacion     String            @map("observacion") @db.VarChar
  idEstadoCaja    Int               @map("id_estado_caja")
  createdAt       DateTime          @default(now()) @map("created_at")
  updatedAt       DateTime?         @default(now()) @map("updated_at")
  deletedAt       DateTime?         @map("deleted_at")
  caja            Caja              @relation(fields: [idCaja], references: [idCaja], onDelete: NoAction, onUpdate: NoAction, map: "caja_apertura_caja_fk")
  estadoCaja      EstadoCaja        @relation(fields: [idEstadoCaja], references: [idEstadoCaja], onDelete: NoAction, onUpdate: NoAction, map: "estado_caja_apertura_caja_fk")
  transaccionCaja TransaccionCaja[]
}

model Caja {
  idCaja       Int            @id @default(autoincrement()) @map("id_caja")
  idUsuario    Int            @map("id_usuario")
  idEstadoCaja Int            @map("id_estado_caja")
  createdAt    DateTime       @default(now()) @map("created_at")
  updatedAt    DateTime?      @default(now()) @map("updated_at")
  deletedAt    DateTime?      @map("deleted_at")
  aperturaCaja AperturaCaja[]
  estadoCaja   EstadoCaja     @relation(fields: [idEstadoCaja], references: [idEstadoCaja], onDelete: NoAction, onUpdate: NoAction, map: "estado_caja_caja_fk")
  usuario      Usuario        @relation(fields: [idUsuario], references: [idUsuario], onDelete: NoAction, onUpdate: NoAction, map: "usuario_caja_fk")
}

model CategoriaEmpresa {
  idCategoriaEmpresa   Int       @id @default(autoincrement()) @map("id_categoria_empresa")
  descCategoriaEmpresa String    @map("desc_categoria_empresa") @db.VarChar
  createdAt            DateTime  @default(now()) @map("created_at")
  updatedAt            DateTime? @default(now()) @map("updated_at")
  deletedAt            DateTime? @map("deleted_at")
  empresa              Empresa[]
}

model Ciudad {
  idCiudad       Int          @id @default(autoincrement()) @map("id_ciudad")
  descCiudad     String       @map("desc_ciudad") @db.VarChar
  departamentoId Int          @map("id_departamento")
  createdAt      DateTime     @default(now()) @map("created_at")
  updatedAt      DateTime?    @default(now()) @map("updated_at")
  deletedAt      DateTime?    @map("deleted_at")
  departamento   Departamento @relation(fields: [departamentoId], references: [idDepartamento])
  empresa        Empresa[]
  persona        Persona[]
}

model Cliente {
  idCliente             Int                     @id @default(autoincrement()) @map("id_cliente")
  idPersona             Int                     @map("id_persona")
  idSectorCliente       Int                     @map("id_sector_cliente")
  idEmpresa             Int?                    @map("id_empresa")
  createdAt             DateTime                @default(now()) @map("created_at")
  updatedAt             DateTime?               @default(now()) @map("updated_at")
  deletedAt             DateTime?               @map("deleted_at")
  empresa               Empresa?                @relation(fields: [idEmpresa], references: [idEmpresa], onDelete: NoAction, onUpdate: NoAction, map: "empresa_cliente_fk")
  persona               Persona                 @relation(fields: [idPersona], references: [idPersona], onDelete: NoAction, onUpdate: NoAction, map: "persona_cliente_fk")
  sectorCliente         SectorCliente           @relation(fields: [idSectorCliente], references: [idSectorCliente], onDelete: NoAction, onUpdate: NoAction, map: "sector_cliente_cliente_fk")
  cotizacionCliente     CotizacionCliente[]
  facturaClienteContado FacturaClienteContado[]
  facturaClienteCredito FacturaClienteCredito[]
  pedidoCliente         PedidoCliente[]
}

model CondicionPago {
  idCondicionPago   Int         @id @default(autoincrement()) @map("id_condicion_pago")
  descCondicionPago String      @map("desc_condicion_pago") @db.VarChar
  createdAt         DateTime    @default(now()) @map("created_at")
  updatedAt         DateTime?   @default(now()) @map("updated_at")
  deletedAt         DateTime?   @map("deleted_at")
}

model CotizacionCliente {
  idCotizacionCliente       Int                        @id @default(autoincrement()) @map("id_cotizacion_cliente")
  fechaCotizacion           DateTime                   @map("fecha_cotizacion") @db.Timestamp(6)
  vendedor                  Int                        @map("vendedor")
  montoTotal                Float                      @map("monto_total")
  idCliente                 Int                        @map("id_cliente")
  validez                   Int                        @map("validez")
  idEstadoCotizacionCliente Int                        @map("id_estado_cotizacion_cliente")
  createdAt                 DateTime                   @default(now()) @map("created_at")
  updatedAt                 DateTime?                  @default(now()) @map("updated_at")
  deletedAt                 DateTime?                  @map("deleted_at")
  cliente                   Cliente                    @relation(fields: [idCliente], references: [idCliente], onDelete: NoAction, onUpdate: NoAction, map: "cliente_cotizacion_cliente_fk")
  estadoCotizacionCliente   EstadoCotizacionCliente    @relation(fields: [idEstadoCotizacionCliente], references: [idEstadoCotizacionCliente], onDelete: NoAction, onUpdate: NoAction, map: "estado_cotizacion_cliente_cotizacion_cliente_fk")
  usuario                   Usuario                    @relation(fields: [vendedor], references: [idUsuario], onDelete: NoAction, onUpdate: NoAction, map: "usuario_cotizacion_cliente_fk")
  detalleCotizacionCliente  DetalleCotizacionCliente[]
}

model CotizacionProveedor {
  idCotizacionProveedor    Int                     @id @default(autoincrement()) @map("id_cotizacion_proveedor")
  idProveedor              Int                     @map("id_proveedor")
  fechaCotizacionProveedor DateTime                @map("fecha_cotizacion_proveedor") @db.Timestamp(6)
  validez                  Int                     @map("validez")
  montoTotal               Float                   @map("monto_total")
  createdAt                DateTime                @default(now()) @map("created_at")
  updatedAt                DateTime?               @default(now()) @map("updated_at")
  deletedAt                DateTime?               @map("deleted_at")
  estado                   String                  @map("estado") @db.VarChar
  proveedor                Proveedor               @relation(fields: [idProveedor], references: [idProveedor], onDelete: NoAction, onUpdate: NoAction, map: "proveedor_cotizacion_proveedor_fk")
  detallesCotizacionProv   DetalleCotizacionProv[] // Cambiado a plural y array para indicar relaci√≥n uno a muchos
  ordenCompra              OrdenCompra[]
}

model DetalleCotizacionCliente {
  idCotizacionCliente Int               @map("id_cotizacion_cliente")
  idProducto          Int               @map("id_producto")
  cantidad            Int               @map("cantidad")
  subtotal            Float             @map("subtotal")
  createdAt           DateTime          @default(now()) @map("created_at")
  updatedAt           DateTime?         @default(now()) @map("updated_at")
  deletedAt           DateTime?         @map("deleted_at")
  cotizacionCliente   CotizacionCliente @relation(fields: [idCotizacionCliente], references: [idCotizacionCliente], onDelete: NoAction, onUpdate: NoAction, map: "cotizacion_cliente_detalle_cotizacion_cliente_fk")
  producto            Producto          @relation(fields: [idProducto], references: [idProducto], onDelete: NoAction, onUpdate: NoAction, map: "producto_detalle_cotizacion_cliente_fk")

  @@id([idCotizacionCliente, idProducto], map: "detalle_cotizacion_cliente_pk")
}

model DetalleCotizacionProv {
  idDetalleCotizacionProv Int                 @id @default(autoincrement()) @map("id_detalle_cotizacion_prov") // Nueva clave primaria
  idCotizacionProveedor   Int                 @map("id_cotizacion_proveedor")
  cantidad                Int                 @map("cantidad")
  precioUnitario          Float               @map("precio_unitario")
  subtotal                Float               @map("subtotal")
  idMateriaPrima          Int                 @map("id_materia_prima")
  createdAt               DateTime            @default(now()) @map("created_at")
  updatedAt               DateTime?           @default(now()) @map("updated_at")
  deletedAt               DateTime?           @map("deleted_at")
  cotizacionProveedor     CotizacionProveedor @relation(fields: [idCotizacionProveedor], references: [idCotizacionProveedor], onDelete: NoAction, onUpdate: NoAction, map: "cotizacion_proveedor_detalle_cotizacion_prov_fk")
  materiaPrima            MateriaPrima        @relation(fields: [idMateriaPrima], references: [idMateriaPrima], onDelete: NoAction, onUpdate: NoAction, map: "materia_prima_detalle_cotizacion_prov_fk")
}

model DetallePagoFacCliente {
  idPagoFactura         Int                   @id(map: "detalle_pago_fac_cliente_pk") @default(autoincrement()) @map("id_pago_factura")
  nroFacClienteCredito  Int                   @map("nro_fac_cliente_credito")
  fechaPago             DateTime              @map("fecha_pago") @db.Timestamp(6)
  montoPago             Float                 @map("monto_pago")
  idMetodoPago          Int                   @map("id_metodo_pago")
  observacion           String                @map("observacion") @db.VarChar
  comprobantePago       String                @map("comprobante_pago") @db.VarChar
  createdAt             DateTime              @default(now()) @map("created_at")
  updatedAt             DateTime?             @default(now()) @map("updated_at")
  deletedAt             DateTime?             @map("deleted_at")
  facturaClienteCredito FacturaClienteCredito @relation(fields: [nroFacClienteCredito], references: [nroFacClienteCredito], onDelete: NoAction, onUpdate: NoAction, map: "factura_cliente_credito_detalle_cobro_factua_fk")
  metodoPago            MetodoPago            @relation(fields: [idMetodoPago], references: [idMetodoPago], onDelete: NoAction, onUpdate: NoAction, map: "metodo_pago_detalle_pago_fac_cliente_fk")
}

model DetallePagoFacProv {
  idPagoFactura        Int                @id(map: "detalle_pago_fac_prov_pk") @default(autoincrement()) @map("id_pago_factura")
  idFacturaCreditoProv Int                @map("id_factura_credito_prov")
  fechaPago            DateTime           @map("fecha_pago") @db.Timestamp(6)
  montoPago            Float              @map("monto_pago")
  idMetodoPago         Int                @map("id_metodo_pago")
  observacion          String             @map("observacion") @db.VarChar
  comprobantePago      String             @map("comprobante_pago") @db.VarChar
  createdAt            DateTime           @default(now()) @map("created_at")
  updatedAt            DateTime?          @default(now()) @map("updated_at")
  deletedAt            DateTime?          @map("deleted_at")
  facturaCreditoProv   FacturaCreditoProv @relation(fields: [idFacturaCreditoProv], references: [idFacturaCreditoProv], onDelete: NoAction, onUpdate: NoAction, map: "factura_credito_prov_pago_factura_fk")
  metodoPago           MetodoPago         @relation(fields: [idMetodoPago], references: [idMetodoPago], onDelete: NoAction, onUpdate: NoAction, map: "metodo_pago_pago_factura_fk")
}

model Empresa {
  idEmpresa          Int              @id(map: "empresa_pk") @default(autoincrement()) @map("id_empresa")
  idCategoriaEmpresa Int              @map("id_categoria_empresa")
  razonSocial        String           @map("razon_social") @db.VarChar
  idTipoDocumento    Int              @map("id_tipo_documento")
  ruc                String           @map("ruc") @db.VarChar
  direccionEmpresa   String           @map("direccion_empresa") @db.VarChar
  idCiudad           Int              @map("id_ciudad")
  correoEmpresa      String           @map("correo_empresa") @db.VarChar
  telefono           String           @map("telefono") @db.VarChar
  createdAt          DateTime         @default(now()) @map("created_at")
  updatedAt          DateTime?        @default(now()) @map("updated_at")
  deletedAt          DateTime?        @map("deleted_at")
  contacto           String           @map("contacto") @db.VarChar
  cliente            Cliente[]
  categoriaEmpresa   CategoriaEmpresa @relation(fields: [idCategoriaEmpresa], references: [idCategoriaEmpresa], onDelete: NoAction, onUpdate: NoAction, map: "categoria_empresa_empresa_fk")
  ciudad             Ciudad           @relation(fields: [idCiudad], references: [idCiudad], onDelete: NoAction, onUpdate: NoAction, map: "ciudad_empresa_fk")
  tipoDocumento      TipoDocumento    @relation(fields: [idTipoDocumento], references: [idTipoDocumento], onDelete: NoAction, onUpdate: NoAction, map: "tipo_documento_empresa_fk")
  proveedor          Proveedor[]
}

model EstadoCaja {
  idEstadoCaja   Int            @id(map: "estado_caja_pk") @default(autoincrement()) @map("id_estado_caja")
  descEstadoCaja String         @map("desc_estado_caja") @db.VarChar
  createdAt      DateTime       @default(now()) @map("created_at")
  updatedAt      DateTime?      @default(now()) @map("updated_at")
  deletedAt      DateTime?      @map("deleted_at")
  aperturaCaja   AperturaCaja[]
  caja           Caja[]
}

model EstadoCotizacionCliente {
  idEstadoCotizacionCliente   Int                 @id(map: "estado_cotizacion_cliente_pk") @default(autoincrement()) @map("id_estado_cotizacion_cliente")
  descEstadoCotizacionCliente String              @map("desc_estado_cotizacion_cliente") @db.VarChar
  createdAt                   DateTime            @default(now()) @map("created_at")
  updatedAt                   DateTime?           @default(now()) @map("updated_at")
  deletedAt                   DateTime?           @map("deleted_at")
  cotizacionCliente           CotizacionCliente[]
}

model EstadoCotizacionProv {
  idEstadoCotizacionProv   Int                   @id(map: "estado_cotizacion_prov_pk") @default(autoincrement()) @map("id_estado_cotizacion_prov")
  descEstadoCotizacionProv String                @map("desc_estado_cotizacion_prov") @db.VarChar
  createdAt                DateTime              @default(now()) @map("created_at")
  updatedAt                DateTime?             @default(now()) @map("updated_at")
  deletedAt                DateTime?             @map("deleted_at")
}

model EstadoFactuCliente {
  idEstadoFactuCliente  Int                     @id(map: "estado_factu_cliente_pk") @default(autoincrement()) @map("id_estado_factu_cliente")
  descEstFactCliente    String                  @map("desc_est_fact_cliente") @db.VarChar
  createdAt             DateTime                @default(now()) @map("created_at")
  updatedAt             DateTime?               @default(now()) @map("updated_at")
  deletedAt             DateTime?               @map("deleted_at")
  facturaClienteContado FacturaClienteContado[]
  facturaClienteCredito FacturaClienteCredito[]
}

model EstadoFacturaProv {
  idEstadoFacturaProv Int                  @id(map: "estado_factura_prov_pk") @default(autoincrement()) @map("id_estado_factura_prov")
  descFacturaProv     String               @map("desc_factura_prov") @db.VarChar
  createdAt           DateTime             @default(now()) @map("created_at")
  updatedAt           DateTime?            @default(now()) @map("updated_at")
  deletedAt           DateTime?            @map("deleted_at")
  facturaContadoProv  FacturaContadoProv[]
  facturaCreditoProv  FacturaCreditoProv[]
}

model EstadoMateriaPrima {
  idEstadoMateriaPrima   Int            @id(map: "estado_materia_prima_pk") @default(autoincrement()) @map("id_estado_materia_prima")
  descEstadoMateriaPrima String         @map("desc_estado_materia_prima") @db.VarChar
  createdAt              DateTime       @default(now()) @map("created_at")
  updatedAt              DateTime?      @default(now()) @map("updated_at")
  deletedAt              DateTime?      @map("deleted_at")
  materiaPrima           MateriaPrima[]
}

model EstadoNota {
  idEstadoNota   Int       @id(map: "estado_nota_pk") @default(autoincrement()) @map("id_estado_nota")
  descEstadoNota String    @map("desc_estado_nota") @db.VarChar
  createdAt      DateTime  @default(now()) @map("created_at")
  updatedAt      DateTime? @default(now()) @map("updated_at")
  deletedAt      DateTime? @map("deleted_at")
  nota           Nota[]
}

model EstadoOrdenCompra {
  idEstadoOrdenCompra   Int           @id(map: "estado_orden_compra_pk") @default(autoincrement()) @map("id_estado_orden_compra")
  descEstadoOrdenCompra String        @map("desc_estado_orden_compra") @db.VarChar
  createdAt             DateTime      @default(now()) @map("created_at")
  updatedAt             DateTime?     @default(now()) @map("updated_at")
  deletedAt             DateTime?     @map("deleted_at")
  ordenCompra           OrdenCompra[]
}

model EstadoOrdenProd {
  idEstadoOrdenProd   Int               @id(map: "estado_orden_prod_pk") @default(autoincrement()) @map("id_estado_orden_prod")
  descEstadoOrdenProd String            @map("desc_estado_orden_prod") @db.VarChar
  createdAt           DateTime          @default(now()) @map("created_at")
  updatedAt           DateTime?         @default(now()) @map("updated_at")
  deletedAt           DateTime?         @map("deleted_at")
  ordenProduccion     OrdenProduccion[]
}

model EstadoPedido {
  idEstadoPedido   Int             @id(map: "estado_pedido_pk") @default(autoincrement()) @map("id_estado_pedido")
  descEstadoPedido String          @map("desc_estado_pedido") @db.VarChar
  createdAt        DateTime        @default(now()) @map("created_at")
  updatedAt        DateTime?       @default(now()) @map("updated_at")
  deletedAt        DateTime?       @map("deleted_at")
  pedidoCliente    PedidoCliente[]
}

model EstadoProducto {
  idEstadoProducto   Int        @id(map: "estado_producto_pk") @default(autoincrement()) @map("id_estado_producto")
  descEstadoProducto String     @map("desc_estado_producto") @db.VarChar
  createdAt          DateTime   @default(now()) @map("created_at")
  updatedAt          DateTime?  @default(now()) @map("updated_at")
  deletedAt          DateTime?  @map("deleted_at")
  productos          Producto[] 
}

model FacturaClienteContado {
  nroFacClienteContado Int                @id(map: "factura_cliente_contado_pk") @map("nro_fac_cliente_contado")
  fechaEmision         DateTime           @map("fecha_emision") @db.Timestamp(6)
  timbrado             Int                @map("timbrado")
  idCliente            Int                @map("id_cliente")
  idPedido             Int                @map("id_pedido")
  operador             Int                @map("operador")
  idImpuesto           Int                @map("id_impuesto")
  montoTotalFactura    Float              @map("monto_total_factura")
  observacion          String             @map("observacion") @db.VarChar
  descuento            Float              @map("descuento")
  idMetodoPago         Int                @map("id_metodo_pago")
  idEstadoFactuCliente Int                @map("id_estado_factu_cliente")
  createdAt            DateTime           @default(now()) @map("created_at")
  updatedAt            DateTime?          @default(now()) @map("updated_at")
  deletedAt            DateTime?          @map("deleted_at")
  cliente              Cliente            @relation(fields: [idCliente], references: [idCliente], onDelete: NoAction, onUpdate: NoAction, map: "cliente_factura_cliente_contado_fk")
  estadoFactuCliente   EstadoFactuCliente @relation(fields: [idEstadoFactuCliente], references: [idEstadoFactuCliente], onDelete: NoAction, onUpdate: NoAction, map: "estado_factu_cliente_factura_cliente_contado_fk")
  impuestos            Impuestos          @relation(fields: [idImpuesto], references: [idImpuesto], onDelete: NoAction, onUpdate: NoAction, map: "impuestos_factura_cliente_contado_fk")
  metodoPago           MetodoPago         @relation(fields: [idMetodoPago], references: [idMetodoPago], onDelete: NoAction, onUpdate: NoAction, map: "metodo_pago_factura_cliente_contado_fk")
  pedidoCliente        PedidoCliente      @relation(fields: [idPedido], references: [idPedido], onDelete: NoAction, onUpdate: NoAction, map: "pedido_cliente_factura_cliente_contado_fk")
  usuario              Usuario            @relation(fields: [operador], references: [idUsuario], onDelete: NoAction, onUpdate: NoAction, map: "usuario_factura_cliente_contado_fk")
  nota                 Nota[]
}

model FacturaClienteCredito {
  nroFacClienteCredito  Int                     @id(map: "factura_cliente_credito_pk") @default(autoincrement()) @map("nro_fac_cliente_credito")
  montoTotalFactura     String                  @map("monto_total_factura") @db.VarChar
  idImpuesto            Int                     @map("id_impuesto")
  idEstadoFactuCliente  Int                     @map("id_estado_factu_cliente")
  fechaEmision          String                  @map("fecha_emision") @db.VarChar
  idPedido              Int                     @map("id_pedido")
  idCliente             Int                     @map("id_cliente")
  timbrado              Int                     @map("timbrado")
  operador              Int                     @map("operador")
  saldoRestante         Float                   @map("saldo_restante")
  plazoPago             Int                     @map("plazo_pago")
  fechaVencimiento      DateTime                @map("fecha_vencimiento") @db.Timestamp(6)
  descuento             Float                   @map("descuento")
  createdAt             DateTime                @default(now()) @map("created_at")
  updatedAt             DateTime?               @default(now()) @map("updated_at")
  deletedAt             DateTime?               @map("deleted_at")
  detallePagoFacCliente DetallePagoFacCliente[]
  cliente               Cliente                 @relation(fields: [idCliente], references: [idCliente], onDelete: NoAction, onUpdate: NoAction, map: "cliente_factura_cliente_credito_fk")
  estadoFactuCliente    EstadoFactuCliente      @relation(fields: [idEstadoFactuCliente], references: [idEstadoFactuCliente], onDelete: NoAction, onUpdate: NoAction, map: "estado_factu_cliente_factura_cliente_credito_fk")
  impuestos             Impuestos               @relation(fields: [idImpuesto], references: [idImpuesto], onDelete: NoAction, onUpdate: NoAction, map: "impuestos_factura_cliente_credito_fk")
  pedidoCliente         PedidoCliente           @relation(fields: [idPedido], references: [idPedido], onDelete: NoAction, onUpdate: NoAction, map: "pedido_cliente_factura_cliente_credito_fk")
  usuario               Usuario                 @relation(fields: [operador], references: [idUsuario], onDelete: NoAction, onUpdate: NoAction, map: "usuario_factura_cliente_credito_fk")
  nota                  Nota[]
}

model FacturaContadoProv {
  idFacturaContadoProv Int               @id(map: "factura_contado_prov_pk") @default(autoincrement()) @map("id_factura_contado_prov")
  idProveedor          Int               @map("id_proveedor")
  fechaEmision         DateTime          @map("fecha_emision") @db.Timestamp(6)
  nroFacProvContado    String            @map("nro_fac_prov_contado") @db.VarChar
  montoTotal           Float             @map("monto_total")
  idEstadoFacturaProv  Int               @map("id_estado_factura_prov")
  idOrdenCompra        Int?              @map("id_orden_compra")
  idMetodoPago         Int               @map("id_metodo_pago")
  comprobantePago      String            @map("comprobante_pago") @db.VarChar
  createdAt            DateTime          @default(now()) @map("created_at")
  updatedAt            DateTime?         @default(now()) @map("updated_at")
  deletedAt            DateTime?         @map("deleted_at")
  estadoFacturaProv    EstadoFacturaProv @relation(fields: [idEstadoFacturaProv], references: [idEstadoFacturaProv], onDelete: NoAction, onUpdate: NoAction, map: "estado_factura_prov_factura_proveedor_fk")
  metodoPago           MetodoPago        @relation(fields: [idMetodoPago], references: [idMetodoPago], onDelete: NoAction, onUpdate: NoAction, map: "metodo_pago_factura_contado_prov_fk")
  ordenCompra          OrdenCompra?      @relation(fields: [idOrdenCompra], references: [idOrdenCompra], onDelete: NoAction, onUpdate: NoAction, map: "orden_compra_factura_proveedor_fk")
  proveedor            Proveedor         @relation(fields: [idProveedor], references: [idProveedor], onDelete: NoAction, onUpdate: NoAction, map: "proveedor_factura_proveedor_fk")
}

model FacturaCreditoProv {
  idFacturaCreditoProv Int                  @id(map: "factura_credito_prov_pk") @default(autoincrement()) @map("id_factura_credito_prov")
  montoTotal           Float                @map("monto_total")
  montoPagado          Float                @map("monto_pagado")
  saldoRestante        Float                @map("saldo_restante")
  plazoPago            Int                  @map("plazo_pago")
  idOrdenCompra        Int?                 @map("id_orden_compra")
  idEstadoFacturaProv  Int                  @map("id_estado_factura_prov")
  fechaEmision         DateTime             @map("fecha_emision") @db.Timestamp(6)
  nroFacProvCredito    String               @map("nro_fac_prov_credito") @db.VarChar
  idProveedor          Int                  @map("id_proveedor")
  fechaVencimiento     DateTime             @map("fecha_vencimiento") @db.Timestamp(6)
  createdAt            DateTime             @default(now()) @map("created_at")
  updatedAt            DateTime?            @default(now()) @map("updated_at")
  deletedAt            DateTime?            @map("deleted_at")
  detallePagoFacProv   DetallePagoFacProv[]
  estadoFacturaProv    EstadoFacturaProv    @relation(fields: [idEstadoFacturaProv], references: [idEstadoFacturaProv], onDelete: NoAction, onUpdate: NoAction, map: "estado_factura_prov_factura_credito_prov_fk")
  ordenCompra          OrdenCompra?         @relation(fields: [idOrdenCompra], references: [idOrdenCompra], onDelete: NoAction, onUpdate: NoAction, map: "orden_compra_factura_credito_prov_fk")
  proveedor            Proveedor            @relation(fields: [idProveedor], references: [idProveedor], onDelete: NoAction, onUpdate: NoAction, map: "proveedor_factura_credito_prov_fk")
}

model Impuestos {
  idImpuesto            Int                     @id(map: "impuestos_pk") @map("id_impuesto")
  descImpuesto          String                  @map("desc_impuesto") @db.VarChar
  porcentajeImpuesto    Float                   @map("porcentaje_impuesto")
  createdAt             DateTime                @default(now()) @map("created_at")
  updatedAt             DateTime?               @default(now()) @map("updated_at")
  deletedAt             DateTime?               @map("deleted_at")
  facturaClienteContado FacturaClienteContado[]
  facturaClienteCredito FacturaClienteCredito[]
}

model Informe {
  idInforme        Int         @id(map: "informe_pk") @default(autoincrement()) @map("id_informe")
  fechaGeneracion  DateTime    @map("fecha_generacion") @db.Timestamp(6)
  usuarioGenerador Int         @map("usuario_generador")
  idTipoInforme    Int         @map("id_tipo_informe")
  createdAt        DateTime    @default(now()) @map("created_at")
  updatedAt        DateTime?   @default(now()) @map("updated_at")
  deletedAt        DateTime?   @map("deleted_at")
  tipoInforme      TipoInforme @relation(fields: [idTipoInforme], references: [idTipoInforme], onDelete: NoAction, onUpdate: NoAction, map: "tipo_informe_informe_fk")
  usuario          Usuario     @relation(fields: [usuarioGenerador], references: [idUsuario], onDelete: NoAction, onUpdate: NoAction, map: "usuario_informe_fk")
}

model MateriaPrima {
  idMateriaPrima        Int                     @id(map: "materia_prima_pk") @default(autoincrement()) @map("id_materia_prima")
  nombreMateriaPrima    String                  @map("nombre_materia_prima") @db.VarChar
  descMateriaPrima      String                  @map("desc_materia_prima") @db.VarChar
  idEstadoMateriaPrima  Int                     @map("id_estado_materia_prima")
  createdAt             DateTime                @default(now()) @map("created_at")
  updatedAt             DateTime?               @default(now()) @map("updated_at")
  deletedAt             DateTime?               @map("deleted_at")
  stockActual           Float                   @default(0) @map("stock_actual")
  detalleCotizacionProv DetalleCotizacionProv[]
  estadoMateriaPrima    EstadoMateriaPrima      @relation(fields: [idEstadoMateriaPrima], references: [idEstadoMateriaPrima], onDelete: NoAction, onUpdate: NoAction, map: "estado_materia_prima_materia_prima_fk")
  inventario            Inventario[] 
}

model MetodoPago {
  idMetodoPago          Int                     @id(map: "metodo_pago_pk") @map("id_metodo_pago")
  descMetodoPago        String                  @map("desc_metodo_pago") @db.VarChar
  createdAt             DateTime                @default(now()) @map("created_at")
  updatedAt             DateTime?               @default(now()) @map("updated_at")
  deletedAt             DateTime?               @map("deleted_at")
  detallePagoFacCliente DetallePagoFacCliente[]
  detallePagoFacProv    DetallePagoFacProv[]
  facturaClienteContado FacturaClienteContado[]
  facturaContadoProv    FacturaContadoProv[]
}

model Nota {
  idNotaCredito         Int                    @id(map: "nota_pk") @default(autoincrement()) @map("id_nota_credito")
  fechaEmision          DateTime               @map("fecha_emision") @db.Timestamp(6)
  motivo                String                 @map("motivo") @db.VarChar
  monto                 Float                  @map("monto")
  idTipoNota            Int                    @map("id_tipo_nota")
  idEstadoNota          Int                    @map("id_estado_nota")
  nroFacClienteCredito  Int?                   @map("nro_fac_cliente_credito")
  nroFacClienteContado  Int?                   @map("nro_fac_cliente_contado")
  createdAt             DateTime               @default(now()) @map("created_at")
  updatedAt             DateTime?              @default(now()) @map("updated_at")
  deletedAt             DateTime?              @map("deleted_at")
  estadoNota            EstadoNota             @relation(fields: [idEstadoNota], references: [idEstadoNota], onDelete: NoAction, onUpdate: NoAction, map: "estado_nota_nota_fk")
  facturaClienteContado FacturaClienteContado? @relation(fields: [nroFacClienteContado], references: [nroFacClienteContado], onDelete: NoAction, onUpdate: NoAction, map: "factura_cliente_contado_nota_fk")
  facturaClienteCredito FacturaClienteCredito? @relation(fields: [nroFacClienteCredito], references: [nroFacClienteCredito], onDelete: NoAction, onUpdate: NoAction, map: "factura_cliente_credito_nota_fk")
  tipoNota              TipoNota               @relation(fields: [idTipoNota], references: [idTipoNota], onDelete: NoAction, onUpdate: NoAction, map: "tipo_nota_nota_fk")
}

model Notificacion {
  idNotificacion Int       @id(map: "notificacion_pk") @default(autoincrement()) @map("id_notificacion")
  mensaje        String    @map("mensaje") @db.VarChar
  fechaEnvio     DateTime  @map("fecha_envio") @db.Date
  usuarioDestino Int       @map("usuario_destino")
  leido          Boolean   @map("leido")
  createdAt      DateTime  @default(now()) @map("created_at")
  updatedAt      DateTime? @default(now()) @map("updated_at")
  deletedAt      DateTime? @map("deleted_at")
  usuario        Usuario   @relation(fields: [usuarioDestino], references: [idUsuario], onDelete: NoAction, onUpdate: NoAction, map: "usuario_notificacion_fk")
}

model OrdenCompra {
  idOrdenCompra         Int                  @id(map: "orden_compra_pk") @default(autoincrement()) @map("id_orden_compra")
  fechaOrden            DateTime             @map("fecha_orden") @db.Timestamp(6)
  idEstadoOrdenCompra   Int                  @map("id_estado_orden_compra")
  idCotizacionProveedor Int                  @map("id_cotizacion_proveedor")
  observacion           String               @map("observacion") @db.VarChar
  createdAt             DateTime             @default(now()) @map("created_at")
  updatedAt             DateTime?            @default(now()) @map("updated_at")
  deletedAt             DateTime?            @map("deleted_at")
  facturaContadoProv    FacturaContadoProv[]
  facturaCreditoProv    FacturaCreditoProv[]
  cotizacionProveedor   CotizacionProveedor  @relation(fields: [idCotizacionProveedor], references: [idCotizacionProveedor], onDelete: NoAction, onUpdate: NoAction, map: "cotizacion_proveedor_orden_compra_fk")
  estadoOrdenCompra     EstadoOrdenCompra    @relation(fields: [idEstadoOrdenCompra], references: [idEstadoOrdenCompra], onDelete: NoAction, onUpdate: NoAction, map: "estado_orden_compra_orden_compra_fk")
  inventario            Inventario[]
}

model OrdenProduccion {
  idOrdenProduccion   Int                 @id(map: "orden_produccion_pk") @default(autoincrement()) @map("id_orden_produccion")
  idPedido            Int                 @map("id_pedido")
  fechaInicioProd     DateTime            @map("fecha_inicio_prod") @db.Timestamp(6)
  fechaFinProd        DateTime            @map("fecha_fin_prod") @db.Timestamp(6)
  operadorEncargado   Int                 @map("operador_encargado")
  idEstadoOrdenProd   Int                 @map("id_estado_orden_prod")
  createdAt           DateTime            @default(now()) @map("created_at")
  updatedAt           DateTime?           @default(now()) @map("updated_at")
  deletedAt           DateTime?           @map("deleted_at")
  estadoOrdenProd     EstadoOrdenProd     @relation(fields: [idEstadoOrdenProd], references: [idEstadoOrdenProd], onDelete: NoAction, onUpdate: NoAction, map: "estado_orden_prod_orden_produccion_fk")
  pedidoCliente       PedidoCliente       @relation(fields: [idPedido], references: [idPedido], onDelete: NoAction, onUpdate: NoAction, map: "pedido_cliente_orden_produccion_fk")
  usuario             Usuario             @relation(fields: [operadorEncargado], references: [idUsuario], onDelete: NoAction, onUpdate: NoAction, map: "usuario_orden_produccion_fk")
  inventarioProducto  InventarioProducto[] // Relaci√≥n inversa con InventarioProducto
}

model PedidoCliente {
  idPedido              Int                     @id(map: "pedido_cliente_pk") @default(autoincrement()) @map("id_pedido")
  fechaPedido           DateTime                @map("fecha_pedido") @db.Timestamp(6)
  fechaEntrega          DateTime?               @map("fecha_entrega") @db.Timestamp(6)
  idCliente             Int                     @map("id_cliente")
  idEstadoPedido        Int                     @map("id_estado_pedido")
  montoTotal            Float                   @map("monto_total")
  vendedor              Int                     @map("vendedor")
  observacion           String                  @map("observacion") @db.VarChar
  createdAt             DateTime                @default(now()) @map("created_at")
  updatedAt             DateTime?               @default(now()) @map("updated_at")
  deletedAt             DateTime?               @map("deleted_at")
  facturaClienteContado FacturaClienteContado[]
  facturaClienteCredito FacturaClienteCredito[]
  ordenProduccion       OrdenProduccion[]
  cliente               Cliente                 @relation(fields: [idCliente], references: [idCliente], onDelete: NoAction, onUpdate: NoAction, map: "cliente_pedido_cliente_fk")
  estadoPedido          EstadoPedido            @relation(fields: [idEstadoPedido], references: [idEstadoPedido], onDelete: NoAction, onUpdate: NoAction, map: "estado_pedido_pedido_cliente_fk")
  usuario               Usuario                 @relation(fields: [vendedor], references: [idUsuario], onDelete: NoAction, onUpdate: NoAction, map: "usuario_pedido_cliente_fk")
  pedidoDetalle         PedidoDetalle[]
}

model PedidoDetalle {
  idPedido      Int
  idProducto    Int
  cantidad      Int
  subtotal      Float
  createdAt     DateTime      @default(now()) @map("created_at")
  updatedAt     DateTime?     @default(now()) @map("updated_at")
  deletedAt     DateTime?     @map("deleted_at")
  pedidoCliente PedidoCliente @relation(fields: [idPedido], references: [idPedido], onDelete: NoAction, onUpdate: NoAction, map: "pedido_cliente_pedido_detalle_fk")
  producto      Producto      @relation(fields: [idProducto], references: [idProducto], onDelete: NoAction, onUpdate: NoAction, map: "producto_pedido_detalle_fk")

  @@id([idPedido, idProducto], map: "pedido_detalle_pk")
}

model Permiso {
  idPermiso     Int          @id(map: "permiso_pk") @default(autoincrement()) @map("id_permiso")
  nombrePermiso String       @map("nombre_permiso") @db.VarChar
  createdAt     DateTime     @default(now()) @map("created_at")
  updatedAt     DateTime?    @default(now()) @map("updated_at")
  deletedAt     DateTime?    @map("deleted_at")
  rolPermiso    RolPermiso[]
}

model Persona {
  idPersona       Int           @id(map: "persona_pk") @default(autoincrement()) @map("id_persona")
  nroDocumento    String        @map("nro_documento") @db.VarChar
  nombre          String        @map("nombre") @db.VarChar
  apellido        String        @map("apellido") @db.VarChar
  fechaNacimiento DateTime      @map("fecha_nacimiento") @db.Date
  direccion       String        @map("direccion") @db.VarChar
  nroTelefono     String        @map("nro_telefono") @db.VarChar
  correoPersona   String        @map("correo_persona") @db.VarChar
  idCiudad        Int           @map("id_ciudad")
  idTipoDocumento Int           @map("id_tipo_documento")
  createdAt       DateTime      @default(now()) @map("created_at")
  updatedAt       DateTime?     @default(now()) @map("updated_at")
  deletedAt       DateTime?     @map("deleted_at")
  cliente         Cliente[]
  ciudad          Ciudad        @relation(fields: [idCiudad], references: [idCiudad], onDelete: NoAction, onUpdate: NoAction, map: "ciudad_persona_fk")
  tipoDocumento   TipoDocumento @relation(fields: [idTipoDocumento], references: [idTipoDocumento], onDelete: NoAction, onUpdate: NoAction, map: "tipo_documento_persona_fk")
  usuario         Usuario[]
}

model Producto {
  idProducto                Int                        @id(map: "producto_pk") @default(autoincrement()) @map("id_producto")
  nombreProducto            String                     @map("nombre_producto") @db.VarChar
  descripcion               String                     @map("descripcion") @db.VarChar
  idTipoProducto            Int                        @map("id_tipo_producto")
  pesoUnidad                Float                      @map("peso_unidad")
  precioUnitario            Float                      @map("precio_unitario")
  idUnidadMedida            Int                        @map("id_unidad_medida")
  idEstadoProducto          Int                        @map("id_estado_producto") 
  stockActual               Int                       @default(0) @map("stock_actual")
  createdAt                 DateTime                   @default(now()) @map("created_at")
  updatedAt                 DateTime?                  @default(now()) @map("updated_at")
  deletedAt                 DateTime?                  @map("deleted_at")
  detalleCotizacionCliente  DetalleCotizacionCliente[]
  pedidoDetalle             PedidoDetalle[]
  tipoProducto              TipoProducto               @relation(fields: [idTipoProducto], references: [idTipoProducto], onDelete: NoAction, onUpdate: NoAction, map: "tipo_producto_producto_fk")
  unidadMedida              UnidadMedida               @relation(fields: [idUnidadMedida], references: [idUnidadMedida], onDelete: NoAction, onUpdate: NoAction, map: "unidad_medida_producto_fk")
  estadoProducto            EstadoProducto             @relation(fields: [idEstadoProducto], references: [idEstadoProducto], onDelete: NoAction, onUpdate: NoAction, map: "estado_producto_producto_fk")
  inventarioProducto        InventarioProducto[]       // Relaci√≥n inversa con InventarioProducto
}

model Proveedor {
  idProveedor          Int                   @id(map: "proveedor_pk") @default(autoincrement()) @map("id_proveedor")
  idEmpresa            Int                   @map("id_empresa")
  createdAt            DateTime              @default(now()) @map("created_at")
  updatedAt            DateTime?             @default(now()) @map("updated_at")
  deletedAt            DateTime?             @map("deleted_at")
  comentario           String                @default("") @map("comentario")
  cotizacionProveedor  CotizacionProveedor[]
  facturaContadoProv   FacturaContadoProv[]
  facturaCreditoProv   FacturaCreditoProv[]
  empresa              Empresa               @relation(fields: [idEmpresa], references: [idEmpresa], onDelete: NoAction, onUpdate: NoAction, map: "empresa_proveedor_fk")
}

model Rol {
  idRol      Int          @id(map: "rol_pk") @default(autoincrement()) @map("id_rol")
  nombreRol  String       @map("nombre_rol") @db.VarChar
  createdAt  DateTime     @default(now()) @map("created_at")
  updatedAt  DateTime?    @default(now()) @map("updated_at")
  deletedAt  DateTime?    @map("deleted_at")
  estadoRol  String       @map("estado_rol") @db.VarChar
  rolPermiso RolPermiso[]
  usuario    Usuario[]
}

model RolPermiso {
  idRol     Int       @map("id_rol")
  idPermiso Int       @map("id_permiso")
  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime? @default(now()) @map("updated_at")
  deletedAt DateTime? @map("deleted_at")
  permiso   Permiso   @relation(fields: [idPermiso], references: [idPermiso], onDelete: NoAction, onUpdate: NoAction, map: "permiso_rol_permiso_fk")
  rol       Rol       @relation(fields: [idRol], references: [idRol], onDelete: NoAction, onUpdate: NoAction, map: "rol_rol_permiso_fk")

  @@id([idRol, idPermiso], map: "rol_permiso_pk")
}

model SectorCliente {
  idSectorCliente   Int       @id(map: "sector_cliente_pk") @map("id_sector_cliente")
  descSectorCliente String    @map("desc_sector_cliente") @db.VarChar
  createdAt         DateTime  @default(now()) @map("created_at")
  updatedAt         DateTime? @default(now()) @map("updated_at")
  deletedAt         DateTime? @map("deleted_at")
  cliente           Cliente[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model SpatialRefSys {
  srid      Int       @id
  authName  String?   @map("auth_name") @db.VarChar(256)
  authSrid  Int?      @map("auth_srid")
  srtext    String?   @map("srtext") @db.VarChar(2048)
  proj4text String?   @map("proj4text") @db.VarChar(2048)
  createdAt DateTime  @default(now()) @map("created_at")
  updatedAt DateTime? @default(now()) @map("updated_at")
  deletedAt DateTime? @map("deleted_at")
}

model TipoDocumento {
  idTipoDocumento   Int       @id(map: "tipo_documento_pk") @default(autoincrement()) @map("id_tipo_documento")
  descTipoDocumento String    @map("desc_tipo_documento") @db.VarChar
  createdAt         DateTime  @default(now()) @map("created_at")
  updatedAt         DateTime? @default(now()) @map("updated_at")
  deletedAt         DateTime? @map("deleted_at")
  empresa           Empresa[]
  persona           Persona[]
}

model TipoInforme {
  idTipoInforme   Int       @id(map: "tipo_informe_pk") @default(autoincrement()) @map("id_tipo_informe")
  descTipoInforme String    @map("desc_tipo_informe") @db.VarChar
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime? @default(now()) @map("updated_at")
  deletedAt       DateTime? @map("deleted_at")
  informe         Informe[]
}

model TipoNota {
  idTipoNota   Int       @id @default(autoincrement()) @map("id_tipo_nota")
  descTipoNota String    @map("desc_tipo_nota")
  createdAt    DateTime  @default(now()) @map("created_at")
  updatedAt    DateTime? @default(now()) @map("updated_at")
  deletedAt    DateTime? @map("deleted_at")
  nota         Nota[]
}

model TipoProducto {
  idTipoProducto   Int        @id(map: "tipo_producto_pk") @default(autoincrement()) @map("id_tipo_producto")
  descTipoProducto String     @map("desc_tipo_producto") @db.VarChar
  createdAt        DateTime   @default(now()) @map("created_at")
  updatedAt        DateTime?  @default(now()) @map("updated_at")
  deletedAt        DateTime?  @map("deleted_at")
  producto         Producto[]
}

model TipoTransaccion {
  idTipoTransaccion   Int               @id(map: "tipo_transaccion_pk") @default(autoincrement()) @map("id_tipo_transaccion")
  descTipoTransaccion String            @map("desc_tipo_transaccion") @db.VarChar
  createdAt           DateTime          @default(now()) @map("created_at")
  updatedAt           DateTime?         @default(now()) @map("updated_at")
  deletedAt           DateTime?         @map("deleted_at")
  transaccionCaja     TransaccionCaja[]
}

model TransaccionCaja {
  idTransaccionCaja Int             @id(map: "transaccion_caja_pk") @default(autoincrement()) @map("id_transaccion_caja")
  idAperturaCaja    Int             @map("id_apertura_caja")
  idTipoTransaccion Int             @map("id_tipo_transaccion")
  monto             Float           @map("monto")
  fechaTransaccion  DateTime        @map("fecha_transaccion") @db.Timestamp(6)
  observacion       String          @map("observacion") @db.VarChar
  createdAt         DateTime        @default(now()) @map("created_at")
  updatedAt         DateTime?       @default(now()) @map("updated_at")
  deletedAt         DateTime?       @map("deleted_at")
  aperturaCaja      AperturaCaja    @relation(fields: [idAperturaCaja], references: [idAperturaCaja], onDelete: NoAction, onUpdate: NoAction, map: "apertura_caja_transaccion_caja_fk")
  tipoTransaccion   TipoTransaccion @relation(fields: [idTipoTransaccion], references: [idTipoTransaccion], onDelete: NoAction, onUpdate: NoAction, map: "tipo_transaccion_transaccion_caja_fk")
}

model UnidadMedida {
  idUnidadMedida   Int            @id(map: "unidad_medida_pk") @default(autoincrement()) @map("id_unidad_medida")
  descUnidadMedida String         @map("desc_unidad_medida") @db.VarChar
  abreviatura      String         @map("abreviatura") @db.VarChar
  createdAt        DateTime       @default(now()) @map("created_at")
  updatedAt        DateTime?      @default(now()) @map("updated_at")
  deletedAt        DateTime?      @map("deleted_at")
  producto         Producto[]
}

model Usuario {
  idUsuario              Int                      @id(map: "usuario_pk") @default(autoincrement()) @map("id_usuario")
  contrasena             String                   @db.VarChar
  nombreUsuario          String                   @map("nombre_usuario") @db.VarChar
  idRol                  Int                      @map("id_rol")
  idPersona              Int                      @map("id_persona")
  estado                 String                   @map("estado_usuario")
  createdAt              DateTime                 @default(now()) @map("created_at")
  updatedAt              DateTime?                @default(now()) @map("updated_at")
  deletedAt              DateTime?                @map("deleted_at")
  ultimoCambioContrasena DateTime                 @default(now()) @map("ultimo_cambio_contrasena") @db.Timestamp(6)
  accessToken            AccessToken[]
  auditoria              Auditoria[]
  caja                   Caja[]
  cotizacionCliente      CotizacionCliente[]
  facturaClienteContado  FacturaClienteContado[]
  facturaClienteCredito  FacturaClienteCredito[]
  informe                Informe[]
  notificacion           Notificacion[]
  ordenProduccion        OrdenProduccion[]
  pedidoCliente          PedidoCliente[]
  RecuperacionContrasena RecuperacionContrasena[]
  refreshToken           RefreshToken[]
  persona                Persona                  @relation(fields: [idPersona], references: [idPersona], onDelete: NoAction, onUpdate: NoAction, map: "persona_usuario_fk")
  rol                    Rol                      @relation(fields: [idRol], references: [idRol], onDelete: NoAction, onUpdate: NoAction, map: "rol_usuario_fk")
}

/*model RecuperacionContrasena {
  idRecuperacion Int      @id @default(autoincrement()) @map("id_recuperacion")
  token          String   @unique
  expiracion     DateTime
  usado          Boolean  @default(false)
  idUsuario      Int      @map("id_usuario")
  createdAt      DateTime @default(now()) @map("created_at")
  updatedAt      DateTime? @updatedAt @map("updated_at")
  deletedAt      DateTime? @map("deleted_at")
  
  usuario        Usuario  @relation(fields: [idUsuario], references: [idUsuario], onDelete: NoAction, onUpdate: NoAction, map: "usuario_recuperacion_fk")

  @@map("RecuperacionContrasena")
}*/

model AccessToken {
  idAccessToken Int           @id @default(autoincrement()) @map("id_access_token")
  accessToken   String        @unique @map("access_token")
  idUsuario     Int           @map("id_usuario")
  createdAt     DateTime      @default(now()) @map("created_at")
  updatedAt     DateTime?     @default(now()) @map("updated_at")
  deletedAt     DateTime?     @map("deleted_at")
  usuario       Usuario       @relation(fields: [idUsuario], references: [idUsuario])
  refreshToken  RefreshToken?
}

model RefreshToken {
  idRefreshToken Int         @id @default(autoincrement()) @map("id_refresh_token")
  refreshToken   String      @unique @map("refresh_token")
  idUsuario      Int         @map("id_usuario")
  idAccessToken  Int         @unique @map("id_access_token")
  createdAt      DateTime    @default(now())
  updatedAt      DateTime?   @default(now())
  deletedAt      DateTime?
  accessToken    AccessToken @relation(fields: [idAccessToken], references: [idAccessToken])
  usuario        Usuario     @relation(fields: [idUsuario], references: [idUsuario])
}

model Departamento {
  idDepartamento   Int       @id @default(autoincrement()) @map("id_departamento")
  descDepartamento String    @map("desc_departamento") @db.VarChar
  createdAt        DateTime  @default(now()) @map("created_at")
  updatedAt        DateTime? @default(now()) @map("updated_at")
  deletedAt        DateTime? @map("deleted_at")
  ciudades         Ciudad[]
}

model RecuperacionContrasena {
  id_recuperacion Int       @id(map: "recuperacion_contrasena_pk") @default(autoincrement())
  token           String    @unique(map: "token_unique") @db.VarChar
  expiracion      DateTime  @db.Timestamp(6)
  usado           Boolean   @default(false)
  id_usuario      Int
  created_at      DateTime  @default(now())
  updated_at      DateTime? @default(now())
  deleted_at      DateTime?
  Usuario         Usuario   @relation(fields: [id_usuario], references: [idUsuario], onDelete: NoAction, onUpdate: NoAction, map: "usuario_recuperacion_fk")

  @@index([token], map: "idx_recuperacion_token")
  @@index([id_usuario], map: "idx_recuperacion_usuario")
}

model Auditoria {
  idAuditoria   Int       @id @default(autoincrement()) @map("id_auditoria")
  entidad       String    @map("entidad") @db.VarChar(255)
  idRegistro    String    @map("id_registro") @db.VarChar(255)
  accion        String    @map("accion") @db.VarChar(50)
  valorAnterior String?   @map("valor_anterior")
  valorNuevo    String?   @map("valor_nuevo")
  idUsuario     Int       @map("id_usuario")
  direccionIP   String?   @map("direccion_ip") @db.VarChar(50)
  navegador     String?   @map("navegador") @db.VarChar(255)
  fechaCreacion DateTime? @default(now()) @map("fecha_creacion") @db.Timestamp(6)
  usuario       Usuario   @relation(fields: [idUsuario], references: [idUsuario], onDelete: Cascade, onUpdate: NoAction, map: "fk_auditoria_usuario")
}

// Modelo para el inventario de materias primas
model Inventario {
  idInventario       Int           @id @default(autoincrement()) @map("id_inventario")
  idMateriaPrima     Int           @map("id_materia_prima")
  cantidad           Float         @default(0)
  unidadMedida       String        @map("unidad_medida") @db.VarChar(20)
  fechaMovimiento    DateTime      @default(now()) @map("fecha_movimiento")
  tipoMovimiento     String        @map("tipo_movimiento") @db.VarChar(20) // "ENTRADA" o "SALIDA"
  idOrdenCompra      Int?          @map("id_orden_compra")
  motivo             String?       @map("motivo") @db.VarChar(100)
  observacion        String?       @db.VarChar(500)
  createdAt          DateTime      @default(now()) @map("created_at")
  updatedAt          DateTime?     @default(now()) @map("updated_at")
  deletedAt          DateTime?     @map("deleted_at")
  
  // Relaciones
  materiaPrima       MateriaPrima  @relation(fields: [idMateriaPrima], references: [idMateriaPrima], onDelete: NoAction, onUpdate: NoAction, map: "inventario_materia_prima_fk")
  ordenCompra        OrdenCompra?  @relation(fields: [idOrdenCompra], references: [idOrdenCompra], onDelete: NoAction, onUpdate: NoAction, map: "inventario_orden_compra_fk")
}

model InventarioProducto {
  idInventarioProducto  Int           @id @default(autoincrement()) @map("id_inventario_producto")
  idProducto            Int           @map("id_producto")
  cantidad              Float         @default(0)
  unidadMedida          String        @map("unidad_medida") @db.VarChar(20)
  fechaMovimiento       DateTime      @default(now()) @map("fecha_movimiento")
  tipoMovimiento        String        @map("tipo_movimiento") @db.VarChar(20) // "ENTRADA" o "SALIDA"
  idOrdenProduccion     Int?          @map("id_orden_produccion")
  motivo                String?       @map("motivo") @db.VarChar(100)
  observacion           String?       @db.VarChar(500)
  createdAt             DateTime      @default(now()) @map("created_at")
  updatedAt             DateTime?     @default(now()) @map("updated_at")
  deletedAt             DateTime?     @map("deleted_at")
  
  // Relaciones
  producto              Producto      @relation(fields: [idProducto], references: [idProducto], onDelete: NoAction, onUpdate: NoAction, map: "inventario_producto_producto_fk")
  ordenProduccion       OrdenProduccion? @relation(fields: [idOrdenProduccion], references: [idOrdenProduccion], onDelete: NoAction, onUpdate: NoAction, map: "inventario_producto_orden_produccion_fk")
}